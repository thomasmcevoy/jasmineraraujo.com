const config = (entries = [], _options) => {
  return [...entries, require.resolve("./preview.mjs")];
};
const webpackFinal = (config2, _options) => {
  var _a, _b;
  if (typeof ((_b = (_a = config2.module) == null ? void 0 : _a.rules) == null ? void 0 : _b[0]) === "object") {
    config2.module.rules[0].exclude = [/node_modules\/(?!(gatsby)\/)/];
    if (Array.isArray(config2.module.rules[0].use) && typeof config2.module.rules[0].use[0] === "object" && typeof config2.module.rules[0].use[0].options === "object") {
      config2.module.rules[0].use[0].options.plugins.push([
        require.resolve("babel-plugin-remove-graphql-queries"),
        {
          stage: config2.mode === `development` ? "develop-html" : "build-html",
          staticQueryDir: "page-data/sq/d"
        }
      ]);
    }
  }
  return config2;
};

export { config, webpackFinal };
